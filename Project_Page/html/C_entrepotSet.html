<!DOCTYPE html>
<html>
  
  <head>
    <meta charset="UTF-8">
    <title>仓库设定</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="../css/font.css">
    <link rel="stylesheet" href="../css/xadmin.css">
    <script src="../js/jquery.min.js"></script>
    <script type="text/javascript" src="../lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/xadmin.js"></script>
    
    <style type="text/css">
    	.layui-input-block {
			    margin-left: 120px;
			    min-height: 36px;
			}
			.layui-row{
				margin-bottom: 10px;
			}
			.layui-form-label {
			    float: left;
			    display: block;
			    padding: 9px 5px;
			    width: 85px;
			    font-weight: 400;
			    line-height: 20px;
			    text-align: right;
			}
			.layui-form-item {
					width: 399px;
			    margin-top: 5px;
			    margin-bottom: 5px;
			    clear: none;
			    display: inline-block;
			}
			.layui-tab-title li {
			    padding: 0 0px; 
			}
			.layui-table {
		    width: 100%;
		    background-color: #fff;
		    color: #666;
		    overflow-y: auto;
			}
			.layui-table thead tr{
				background-color: #d7e7ff !important;
			}
			.layui-table td, .layui-table th{
		    border-width: 1px;
		    border-style: solid;
		    border-color: #d3d1d1;
			}
			.color{
				color: blue;
			}
    </style>
  </head>
  
  <body>
    <div class="x-body" id="main-div">
       <div class="layui-container" style="padding: 8px;">  
				<!--标题开始-->
		  	<div class="layui-row">
			    <div class="layui-col-md12">
			   		<span style="font-size: 18px;padding-left: 15px;">
			   			仓库设定
			   		</span>
			    </div>
		  	</div>
				<!--标题结束-->
				
				<!--主体开始-->
	  		<div class="layui-row">
		   		<form class="layui-form" action="">
					  <div class="layui-form-item layui-col-md4 layui-col-md-offset4">
					    <label class="layui-form-label color">仓库编号</label>
					    <div class="layui-input-block">
					      <input type="text" name="title" required  lay-verify="required" placeholder="请输入仓库编号" v-model="comwarehouse.warehouseid"  autocomplete="off" class="layui-input" id="warehouseid">
					    </div>
					  </div>
					  <div class="layui-form-item layui-col-md4 layui-col-md-offset4">
					    <label class="layui-form-label color">仓库名称</label>
					    <div class="layui-input-block">
					      <input type="text" name="title" required  lay-verify="required" placeholder="请输入仓库名称" v-model="comwarehouse.warehousename"  autocomplete="off" class="layui-input">
					    </div>
					  </div>
					  <div class="layui-form-item layui-col-md4 layui-col-md-offset4">
					    <label class="layui-form-label ">仓库简介</label>
					    <div class="layui-input-block">
					      <input type="text" name="title" required  lay-verify="required" placeholder="请输入仓库简介" v-model="comwarehouse.shortname"  autocomplete="off" class="layui-input">
					    </div>
					  </div>
					  <div class="layui-form-item layui-col-md4 layui-col-md-offset4">
					    <label class="layui-form-label ">英文名称</label>
					    <div class="layui-input-block">
					      <input type="text" name="title" required  lay-verify="required" placeholder="请输入英文名称" v-model="comwarehouse.engname"  autocomplete="off" class="layui-input">
					    </div>
					  </div>
					  <div class="layui-form-item layui-col-md4 layui-col-md-offset4">
					    <label class="layui-form-label ">联系人员</label>
					    <div class="layui-input-block">
					      <input type="text" name="title" required  lay-verify="required" placeholder="请输入联系人员" v-model="comwarehouse.linkman"  autocomplete="off" class="layui-input">
					    </div>
					  </div>
					  <div class="layui-form-item layui-col-md4 layui-col-md-offset4">
					    <label class="layui-form-label ">联系电话</label>
					    <div class="layui-input-block">
					      <input type="text" name="title" required  lay-verify="required" placeholder="请输入联系电话" v-model="comwarehouse.telephone" autocomplete="off" class="layui-input">
					    </div>
					  </div>
					  <div class="layui-form-item layui-col-md4 layui-col-md-offset4">
					    <label class="layui-form-label ">仓库地址</label>
					    <div class="layui-input-block">
					      <input type="text" name="title" required  lay-verify="required" placeholder="请输入仓库地址" v-model="comwarehouse.warehouseaddress" autocomplete="off" class="layui-input">
					    </div>
					  </div>
					  <div class="layui-form-item layui-col-md4 layui-col-md-offset4">
					    <label class="layui-form-label ">备注</label>
					    <div class="layui-input-block">
					      <textarea name="" placeholder="请输入备注内容" v-model="comwarehouse.memo" rows="4" class="layui-textarea"></textarea>
					    </div>
					  </div>
					</form>
		  	</div>
				<!--主体结束-->
		  </div>
    </div>
    
    <!--<script src="../layui.all.js"></script>
		<script src="../js/jquery.min.js"></script>
		<script src="../js/jquery.min.js"></script>-->
		<script type="text/javascript" src="../lib/layui/layui.js" charset="utf-8"></script>
		<script type="text/javascript" src="../js/xadmin.js"></script>
		<script type="text/javascript" src="../js/vue.js"></script>
		<script type="text/javascript" src="../js/axios.min.js"></script>
		<script type="text/javascript">
			//必须设置允许跨域访问session中数据(cooike)
			axios.default.withCredentials = true;
			
			var state = "";
			
			function subpageTriggerEvent(incident){
				//alert("部门设定页 - 触发事件：" + incident);
				
				if(incident == "goFirstPage"){
					listVm.goFirstPage();
				} else if(incident == "goPrePage"){
					listVm.goPrePage();
				} else if(incident == "goNextPage"){
					listVm.goNextPage();
				} else if(incident == "goLastPage"){
					listVm.goLastPage();
				} else if(incident == "goInsert"){
					listVm.goInsert();
				} else if(incident == "save"){
					listVm.save();
				} else if(incident == "cancel"){
					listVm.cancel();
				} else if(incident == "goUpdate"){
					listVm.goUpdate();
				} else if(incident == "delete"){
					listVm.delete_();
				} else if(incident == "refresh"){
					listVm.refresh();
				}
				
				state = incident;
			}
		
			//创建vue实例
			var listVm = new Vue({
				el : "#main-div",
				data : {
					pageCd : {},
					comwarehouse : {
						pageNum : 1
					},
					state : ""
				},
				methods : {
					queryPage : function(pageNum_){
						$(".layui-form-item>div>input,.layui-form-item>div>textarea").prop("disabled", true);
						$("#warehouseid").prop("readonly", true);
						
						var this_ = this;
						this.comwarehouse.pageNum = pageNum_;
						
						axios.post(`http://localhost:8080/SoftwareFactoryProject_/warehouses/cwh`, this.comwarehouse).then(function(res){
							//数据正常		/alert(JSON.stringify(res.data));
							this_.pageCd = res.data;
							this_.comwarehouse = this_.pageCd.list[0];
						});
					},
		   			goFirstPage : function(){
		   				this.queryPage(1);
		   			},
		   			goPrePage : function(){
		   				if(this.pageCd.hasPreviousPage)
		      				this.queryPage(this.pageCd.prePage);
		   			},
		   			goNextPage : function(){
		   				if(this.pageCd.hasNextPage)
		      				this.queryPage(this.pageCd.nextPage);
		   			},
		   			goLastPage : function(){
		   				this.queryPage(this.pageCd.pages);
		   			},
					goInsert : function(){
						$(".layui-form-item>div>input,.layui-form-item>div>textarea").prop("disabled", false);
						$("#warehouseid").prop("readonly", false);
						this.state = "goInsert";
						
						this.comwarehouse = {};
					},
					save : function(){
						//alert("执行" + this.state + "操作！");
						var this_ = this;
						this.comwarehouse.flag = this.state;
						
						axios.put(`http://localhost:8080/SoftwareFactoryProject_/warehouses/cwh`, this.comwarehouse).then(function(res){
							//数据正常		/alert(JSON.stringify(res));
							if(res.data.code == "1"){
		   						this_.queryPage((this_.pageCd.pages+1));
								return false;
							} else if(res.data.code == "2"){
								$(".layui-form-item>div>input,.layui-form-item>div>textarea").prop("disabled", true);
								return false;
							}
							alert("非常遗憾，本次" + res.data.message);
						});
					},
					cancel : function(){
						if(this.state == "goInsert"){
			   				if(confirm("确定取消本次新增操作吗！？"))
								this.queryPage(1);
						} else if(this.state == "goUpdate"){
			   				if(confirm("确定取消本次修改操作吗！？"))
		   						this.queryPage(this.pageCd.pages);
						}
					},
					goUpdate : function(){
						$(".layui-form-item>div>input,.layui-form-item>div>textarea").prop("disabled", false);
						this.state = "goUpdate";
					},
					delete_ : function(){
		   				if(!confirm("确定删除本条仓库数据吗？"))
		   					return false;
		   				
						var this_ = this;
		   				//数据无误			alert("参数：" + this.comwarehouse.warehouseid);
		   				axios.delete(`http://localhost:8080/SoftwareFactoryProject_/warehouses/cwh/` + this.comwarehouse.warehouseid).then(function(res){
							//数据正常		/alert(JSON.stringify(res));
							if(res.data.code == "1"){
								this_.queryPage(1);
								return false;
							}
							alert("非常遗憾，本次" + res.data.message);
						});
					},
					refresh : function(){
						this.queryPage(1);
					}
				},
				mounted : function(){
					this.queryPage(1);
				}
			});
		</script>
    <script>
			/*var date = layui.laydate;
			//执行一个laydate实例
			date.render({
				elem: '#date' //指定元素
			});
			date.render({
				elem: '#date',
				format: 'yyyyMMdd'
			});*/
		</script>
  </body>
</html>