<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="js/resources/css/ext-all.css" />
		<script type="text/javascript" src="js/ext-all.js"></script>
		<script type="text/javascript" src="js/locale/ext-lang-zh_CN.js"></script>
		<script type="text/javascript">
			Ext.onReady(function() {
				// 籍贯下拉列表中的值
				var jiguandata = [{
						'text': '安徽',
						"value": "anhui"
					},
					{
						'text': '新疆',
						"value": "xinjiang"
					},
					{
						'text': '广东',
						"value": "guangdong"
					},
					{
						'text': '北京',
						"value": "beijing"
					}
				];

				// 籍贯的Store对象 
				var jiguanStore = Ext.create('Ext.data.Store', {
					fields: ['text', 'value'],
					data: jiguandata
				});

				// 创建 from.Panel 面板,然后内嵌到 Window 面板中
				var formControl = Ext.create('Ext.form.Panel', {
					border: false,
					fieldDefaults: {
						msgTarget: "side", // 错误提示信息在右旁边显示图标
						labelWidth: 60,
						labelAlign: "right",
						margin: 2
					},
					//	defaultType : 'textfield',
					layout: "anchor",
					items: [
						{
							xtype: "container",
							layout: 'hbox',
							margin: 5,
							items: [{
									xtype: 'textfield',
									name: 'name',
									id: 'name',
									fieldLabel: "姓名",
									width: '50%',
									labelSeParator: "<font color ='red'> *</font>:",
									allowBlank: false
								},
								{
									xtype: 'numberfield',
									name: 'age',
									id: 'age',
									fieldLabel: "年龄",
									decimalPrecision: 0,
									//	vtype: 'age',
									//	regex : /^\d+$,
									//	regexText: '请输入正确的编码格式',
									minValue: 10,
									labelSeparator: "<font color ='red'>*</font>:",
									value: 10,
									width: '50%',
								}
							]
						},
						{
							xtype: "container",
							layout: 'hbox',
							margin: 5,
							items: [{
									xtype: 'textfield',
									name: 'address',
									id: 'address',
									fieldLabel: "家庭住址",
									allowBlank: false,
									width: '50%',
								},
								{
									xtype: 'datefield',
									name: 'dateLibary',
									id: 'dateLibary',
									fieldLabel: "出生日期",
									format: 'Y-m-d',
									allowBlank: false,
									width: '50%',
								},
							]
						},
						{
							xtype: "container",
							layout: 'hbox',
							margin: 5,
							items: [{
									xtype: 'timefield',
									name: 'dateReg',
									id: 'dateReg',
									fieldLabel: "注册时间",
									allowBlank: false,
									format: 'H:i:s',
									increment: 5, //时间颗粒度 
									emptyText: '请选择',
									width: '50%',
								},
								{
									xtype: 'radiogroup', // fieldcontainer
									id: 'color',
									fieldLabel: '性别',
									labelSeparator: "<font color ='red'> *</font>:",
									//  defaultType: 'radio',  
									width: '50%',
									defaults: {
										flex: 1
									},
									layout: 'hbox',
									items: [{
											boxLabel: '男',
											name: 'color',
											inputValue: '1',
											//     id        : 'radio1',
											checked: true,
										},
										{
											boxLabel: '女',
											name: 'color',
											inputValue: '0',
											//     id        : 'radio2'  ,
										}

									]
								}
							]
						},
						{
							// 复选框
							xtype: "container",
							layout: 'hbox',
							margin: 5,
							items: [
								{
									xtype: 'fieldcontainer', // fieldcontainer
									fieldLabel: '爱好',
									defaultType: 'checkboxfield', // checkbox
									defaults: {
										flex: 1
									},
									layout: 'hbox',
									width: '50%',
									items: [{
											boxLabel: '看书',
											name: 'check1',
											inputValue: '1',
											id: 'check1',
											checked: true
										},
										{
											boxLabel: '游泳',
											name: 'check2',
											inputValue: '2',
											id: 'check2'
										},
										{
											boxLabel: "啪啪",
											name: 'check3',
											inputValue: '3',
											id: 'check3'
										}
									]
								},
								{
									// 下拉列表
									xtype: 'combobox',
									name: 'cmjiguan',
									id: 'cmjiguan',
									fieldLabel: "籍贯",
									store: jiguanStore,
									queryMode: 'local',
									displayField: 'text',
									valueField: 'value',
									emptyText: '请选择',
									blankText: '请选择籍贯',
									width: '50%',
								}
							]
						},
						{
							xtype: 'container',
							margin: 5,
							layout: 'vbox',
							anchor: "100%",
							items: [{
								xtype: 'textarea',
								name: 'remark',
								id: 'remark',
								fieldLabel: "备注",
								width: '100%',
								//	flex: 1
							}]
						}
					]
				});

				// 结果集的保存--修改
				function onUserSaveClick() {
					display = "操作失败,请重新 进行操作";
					var tuserID = Ext.getCmp('name').getValue();
					var form = formControl.getForm();
					if(form.isValid()) {
						if(tuserID.length > 0) // 更新 
						{
							console.info("正在进行更新");
							form.submit({
								url: '<%=basePath %>user!Updatedata',
								waitMag: "正在进行更新 ,请稍候...",
								success: function(form, action) {
									alert("成功");
								},
								failure: function(from, action) {
									alert("失败");
								}
							});
						} else {
							console.info("正在进行添加");
							form.submit({
								url: '<%=basePath %>user!Insertdata',
								waitMag: "正在进行添加 ,请稍候...",
								success: function(form, action) {
									showDisplay("操作成功");
									userWindowPanel.close();
								},
								failure: function(from, action) {
									showDisplay("操作失败,请重新进行");
								}
							});

						}
					}
				}

				var win = Ext.create('Ext.window.Window', {
					id: "myWin",
					title: "示例窗口",
					width: 500,
					height: 300,
					layout: 'fit',
					modal: true,
					closable: false, // Extjs Window可以配置是否显示关闭按钮：
					closeAction: 'hide', // 在关闭Extjs Window的时候，通过配置项closeAction可以控制按钮是销毁（destroy）还是隐藏（hide），默认情况下为销毁：
					maximizable: true, // 最大化按钮
					minimizable: true, // 最小化按钮 
					items: formControl,
					// anchor:"100% 100%",
					buttons: [{
							xtype: 'button',
							text: "确定",
							handler: showValue
						},
						{
							xtype: 'button',
							text: "验证",
							handler: onUserSaveClick
						}
					],
					listeners: {
						// 最小化
						minimize: function(win, opts) {
							win.collapse();
						}

					}
				}).show();

				function showValue() {
					var svalue = Ext.getCmp('name').getValue() + "---" +
						Ext.getCmp('age').getValue() + "---" +
						Ext.getCmp('address').getValue() + "---" +
						Ext.getCmp('dateLibary').getValue() + "---" +
						Ext.getCmp('dateReg').getValue() + "---单选1: " +
						Ext.getCmp('color').getChecked()[0].boxLabel + "---单选1: " +
						Ext.getCmp('color').getChecked()[0].inputValue + "---复选 : " +
						// Ext.getCmp('radio1').getValue() + "---单选2: " + 
						// Ext.getCmp('radio2').getValue() + "---复选 " + 
						Ext.getCmp('check1').getValue() + "---" +
						Ext.getCmp('check2').getValue() + "---" +
						Ext.getCmp('check3').getValue() + "---" +
						Ext.getCmp('cmjiguan').getValue() + "---" +
						Ext.getCmp('remark').getValue();

					Ext.getCmp('remark').setValue(svalue);
					/*
					name
					age
					address
					dateLibary
					dateReg
					color
					check1
					check2
					check3
					cmjiguan
					remark
					*/
				}
			});
		</script>
	</head>

	<body>
	</body>

</html>